{"name":"Anti-malarial SNPs","tagline":"Pipeline to detect SNPs in specific codons of genes associated with antimalarial drug resistance","body":"Detect SNPs in codons of antimalarial drug resistance genes\r\n===========================================================\r\n`anti_malaria_snps.sh` is a BASH-scripted pipeline that can be used to identify SNPs in specific codons of \r\n_Plasmodium falciparum_ genes that are associated with antimalarial drug resistance. \r\nCurrently, the following genes and codons are supported:\r\n\r\n| Gene     | Codons                   |\r\n|----------|:------------------------:|\r\n| _pfmdr1_ | 86, 184, 1034, 1042,1246 |\r\n| _pfcrt_  | 72, 73, 74, 75, 76       |\r\n| _dhps_   | 436, 437, 540, 581, 613  |\r\n| _dhfr_   | 51, 59, 108, 164         |\r\n\r\nUsing ABI Sanger sequencing trace files of whole gene (or regions spanning codons of interest) from several samples, \r\nthis pipeline outputs a CSV-formatted file of sample name, codons and their corresponding amino acids.\r\n\r\nThis pipeline is a combination of existing tools (such as [BWA](http://bio-bwa.sourceforge.net/), [sam2fasta.py](http://sourceforge.net/projects/sam2fasta/files/), [abifpy](https://github.com/bow/abifpy)) and custom scripts and is made up of the following steps:\r\n\r\n1. Base calling and quality control, \r\n2. Alignment of trimmed and filtered sequences to coding sequence of respective reference gene, \r\n3. Conversion of alignment from SAM to FASTA format, \r\n4. Parse FASTA alignment to output codons and corresponding amino acid in CSV format.\r\n\r\n-----------------------------------------------------------\r\nInstallation\r\n-----------------------------------------------------------\r\n1. First, ensure that the dependencies are installed. Follow the respective links to install: [BWA](http://bio-bwa.sourceforge.net/), [sam2fasta.py](http://sourceforge.net/projects/sam2fasta/files/), [abifpy](https://github.com/bow/abifpy)\r\n2. Download the source [`.zip`](https://github.com/Setfelix/anti_malaria_snps/zipball/master) or [`.tar.gz`](https://github.com/Setfelix/anti_malaria_snps/tarball/master) file and extract\r\n3. Optionally, add the anti_malaria_snps directory to your `$PATH` (in `.bashrc`, for example, to make it persistent) \r\n\r\n-----------------------------------------------------------\r\nUsage\r\n-----------------------------------------------------------\r\n\r\n         bash anti_malaria_snps.sh <directory_of_ab1_files> <reference_gene_coding_sequence> <gene> <quality_cutoff>\r\nwhere: \r\n        \r\n        <directory_of_ab1_files> is directory containing ab1 trace files of a single gene (pfcrt, pfmdr1, dhps, or dhfr)\r\n        <reference_gene_coding_sequence> is path to reference coding sequence of respective gene\r\n        <gene> is pfcrt, pfmdr1, dhps, or dhfr\r\n        <quality_cutoff> is the error probability for trimming bases. \r\n                        Trimming is based on modified Richard Mott's algorithm.\r\n                        This argument is OPTIONAL. Default value is 0.05.\r\n                        Legal values range from 0 to 1.\r\n        \r\n-------------------------------------------------------------------------------------------------------------\r\nExample\r\n-------------------------------------------------------------------------------------------------------------\r\n        bash anti_malaria_snps.sh ~/pfcrt_ab1_seq/ ~/anti_mdr_snps/pfcrt_pf3D7_cds.fasta pfcrt 0.01\r\n\r\n------------------------------------------------------------------------------------------------------------\r\nOutput\r\n------------------------------------------------------------------------------------------------------------\r\nThe output file is named in this format: `gene_dd_mm_yy.csv` and is stored in the `<directory_of_ab1_files>`\r\nThe output for the example above could look like this:\r\n\r\n| Sample   | Codon_72 | Codon_72_aa | Codon_73 | Codon_73_aa | Codon_74 | Codon_74_aa | Codon_75 | Codon_75_aa | Codon_76 | Codon_76_aa |\r\n|----------|:--------:|:-----------:|:--------:|:-----------:|:--------:|:-----------:|:--------:|:-----------:|:--------:|:-----------:|\r\n| 89C_CRT  | TGT      | C           | GTA      | V           | ATG      | M           | AAT      | N           | AAA      | K           |\r\n| 90C_CRT  | TGT      | C           | GTA      | V           | ATG      | M           | AAT      | N           | AAA      | K           |\r\n| 92C_CRT  | TGT      | C           | GTA      | V           | ATG      | M           | AAT      | N           | AAA      | K           |\r\n| 93C_CRT  | TGT      | C           | GTA      | V           | ATG      | M           | AAT      | N           | AAA      | K           |\r\n| 94C_CRT  | TGT      | C           | GTA      | V           | ATG      | M           | AAT      | N           | AAA      | K           |\r\n| 97C_CRT  | TGT      | C           | GTA      | V           | ATG      | M           | AAT      | N           | AAA      | K           |\r\n| 99C_CRT  | TGT      | C           | GTA      | V           | ATG      | M           | AAT      | N           | AAA      | K           |\r\n| PfCRT_ref| TGT      | C           | GTA      | V           | ATG      | M           | AAT      | N           | AAA      | K           |\r\n\r\n------------------------------------------------------------------------------------------------------------\r\nExample data\r\n------------------------------------------------------------------------------------------------------------\r\n\r\nThe archived file containing the source code for this pipeline also contains some `example_data`.\r\nThe `example_data` directory contains:\r\n\r\n1. `example_ab1`             : This directory contains 50 ab1 trace files obtained from sequencing regions of _pfcrt_ \r\n                               spanning codons 72 - 76 from 50 _P. falciparum_ isolates.\r\n                               This directory can be used as `<directory_of_ab1_files>`. \r\n                               It also contains 3 intermediate files (`pfcrt_30_06_15.fasta`, `pfcrt_30_06_15.sam`, \r\n                               `pfcrt_30_06_15.fastq`) and the main output file (`pfcrt_30_06_15.csv`).\r\n                               Typically, `<directory_of_ab1_files>` will not contain any intermediate files or \r\n                               output file until you have ran the pipeline successfully.\r\n                              \r\n2. `pfcrt_pf3d7_cds.fasta`   : The reference coding sequence for _pfcrt_. \r\n                               This file can be used as `<reference_gene_coding_sequence>`. \r\n                               Reference was originally downloaded from [plasmodb.org](http://plasmodb.org/plasmo/).\r\n   \r\n                              \r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}